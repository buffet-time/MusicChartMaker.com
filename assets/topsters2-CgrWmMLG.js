import{b as e,c as t,d as n,e as r,f as i,g as a,h as o,i as s,j as c,k as l,l as u}from"./index-Dqs0MnW6.js";let d=e();function f({propertyName:e,decodedTopsters2:t}){return Uint8Array.from(atob(t[e].substring(1,t[e].length-1)),e=>e.charCodeAt(0))}async function p(e){let{inflate:n}=await t(async()=>{let{inflate:e}=await import(`./pako.esm-CyMyK3ux.js`);return{inflate:e}},[]);return JSON.parse(new TextDecoder().decode(n(e)))}function m(e){try{let t=e.target?.files[0];if(!t)return;let m=new FileReader;m.onload=async e=>{try{let t,d,m=e.target?.result;if(!m)throw Error(`Invalid event target.)`);let g=JSON.parse(atob(m.split(``).map(e=>String.fromCharCode(e.charCodeAt(0)-17)).join(``)))[0],_=Object.keys(g),v=_.find(e=>e.includes(`cards-cards`));t=v&&g[v].length>g.cards.length?f({propertyName:v,decodedTopsters2:g}):f({propertyName:`cards`,decodedTopsters2:g}),(d=await p(t)).splice(Number(g.size));let y=[],b=[],x=Number(g.size);switch(x){case 100:h({decodedTopsters2CardsArray:d,newAlbumTileArray:y,rowSizes:s.rowSizes}),b=s.rowSizes;break;case 42:h({decodedTopsters2CardsArray:d,newAlbumTileArray:y,rowSizes:c.rowSizes}),b=c.rowSizes;break;case 40:{let e=[8,8,8,8,8];h({decodedTopsters2CardsArray:d,newAlbumTileArray:y,rowSizes:e}),b=e;break}default:{let e=function(e){let t=Math.sqrt(e);if(t%1==0&&t*t===e)return[t,t];let n=[...Array(e+1).keys()].filter(t=>e%t==0);return[n[n.length/2-1],n[n.length/2]]}(x),t=[];for(let n=0;n<e[0];n++)t.push(e[1]),n++;h({decodedTopsters2CardsArray:d,newAlbumTileArray:y,rowSizes:t}),b=t}}let S=_.filter(e=>e.includes(`titled`)).find(e=>e.includes(`cards`))?.replace(`-cards-titled`,``),C=o(S||`FailedToImportChartName`),w=a(C,y,{default:!1,rowSizes:b,presetName:`Topsters2Import`});r.value.unshift(C),i.value=C,l(C),u(C,w),n.value=w}catch(e){console.error(`Error occurred importing from Topsters2, if this seems incorrect please report a bug (see site info!): ${e}`),d.newToast({text:`Error occurred importing from Topsters2, see console.`,status:`error`})}},m.readAsText(t)}catch(e){console.error(`Error occurred importing from Topsters2, if this seems incorrect please report a bug (see site info!): ${e}`),d.newToast({text:`Error occurred importing from Topsters2, see console.`,status:`error`})}}function h({rowSizes:e,newAlbumTileArray:t,decodedTopsters2CardsArray:n}){for(let r of e){let e=n.splice(0,r);t.push(e.map(e=>{let t=e.title.split(` - `);return{image:e.src,artist:t[0],name:t[1]}}))}}export{m as importFromTopsters2};